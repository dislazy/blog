{"title":"Docker故障记录","slug":"Docker故障记录","date":"2018-10-14T09:55:13.000Z","updated":"2022-06-02T01:05:59.612Z","comments":true,"path":"api/articles/Docker故障记录.json","excerpt":"1.故障起因正常使用docker查看镜像日志过程中，发现系统插播了一条奇怪的错误日志，如下","covers":["https://imagecdn.bosong.online/image/tnhsrjmjs2gtcqs1arohd4n7p9.png"],"content":"<h3 id=\"1-故障起因\"><a href=\"#1-故障起因\" class=\"headerlink\" title=\"1.故障起因\"></a>1.故障起因</h3><p>正常使用docker查看镜像日志过程中，发现系统插播了一条奇怪的错误日志，如下</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@liunian127~]# </span><br><span class=\"line\">Message from syslogd@i1234567890 at Mar xxx.xxx.xxx.xxx ...</span><br><span class=\"line\"> kernel:unregister_netdevice: waiting for lo to become free. Usage count = 1</span><br></pre></td></tr></table></figure>\n<p>查询之后，简单认为是linux内核与docker内核之间的问题，内核之间的问题技术能力不够暂时没法解决</p>\n<p>然后决定对linux进行一次update 使用 <code>yum update</code> update了431个包，之后未进行改动，访问该博客网站，结果提示，502错误</p>\n<p>之后到控制台查看日志，如下图</p>\n<p><img src=\"https://imagecdn.bosong.online/image/tnhsrjmjs2gtcqs1arohd4n7p9.png\" class=\"lazyload\" data-srcset=\"https://imagecdn.bosong.online/image/tnhsrjmjs2gtcqs1arohd4n7p9.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" alt=\"错误日志\"></p>\n<p>简单来看是由于无法解析到我的mysql服务器的域名，然后在linux主机上ping该域名，发现能ping通 </p>\n<p>之后决定 <code>vi  /etc/hosts</code> 将该域名对应的IP 与域名添加进host文件内，然后重启net服务，重启之后重新生成该镜像并重启 </p>\n<p>问题未得到解决。</p>\n<p>再之后决定用一个笨方法 在启动命令中添加  <code>--net=host</code>  将主机net服务完全与docker服务共享，重新后问题得到解决。</p>\n<p>暂时解决该问题，目前使用的方法就这一个成功，后续会进行更多调研。</p>\n\n","more":"\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@liunian127~]# </span><br><span class=\"line\">Message from syslogd@i1234567890 at Mar xxx.xxx.xxx.xxx ...</span><br><span class=\"line\"> kernel:unregister_netdevice: waiting for lo to become free. Usage count = 1</span><br></pre></td></tr></table></figure>\n<p>查询之后，简单认为是linux内核与docker内核之间的问题，内核之间的问题技术能力不够暂时没法解决</p>\n<p>然后决定对linux进行一次update 使用 <code>yum update</code> update了431个包，之后未进行改动，访问该博客网站，结果提示，502错误</p>\n<p>之后到控制台查看日志，如下图</p>\n<p><img src=\"https://imagecdn.bosong.online/image/tnhsrjmjs2gtcqs1arohd4n7p9.png\" class=\"lazyload\" data-srcset=\"https://imagecdn.bosong.online/image/tnhsrjmjs2gtcqs1arohd4n7p9.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" alt=\"错误日志\"></p>\n<p>简单来看是由于无法解析到我的mysql服务器的域名，然后在linux主机上ping该域名，发现能ping通 </p>\n<p>之后决定 <code>vi  /etc/hosts</code> 将该域名对应的IP 与域名添加进host文件内，然后重启net服务，重启之后重新生成该镜像并重启 </p>\n<p>问题未得到解决。</p>\n<p>再之后决定用一个笨方法 在启动命令中添加  <code>--net=host</code>  将主机net服务完全与docker服务共享，重新后问题得到解决。</p>\n<p>暂时解决该问题，目前使用的方法就这一个成功，后续会进行更多调研。</p>\n\n","categories":[{"name":"Docker","path":"api/categories/Docker.json"}],"tags":[{"name":"Docker","path":"api/tags/Docker.json"}]}